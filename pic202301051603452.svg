<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="800px" preserveAspectRatio="none" style="width:1968px;height:800px;background:#FFFFFF;" version="1.1" viewBox="0 0 1968 800" width="1968px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.2969" id="_title" style="stroke:none;stroke-width:1.0;" width="160" x="900" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="150" x="905" y="27.9951">美西用户，在欧洲地区</text><rect fill="#FFFFFF" height="581.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="17" y="128.5938"/><rect fill="#FFFFFF" height="116.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="192.8594"/><rect fill="#FFFFFF" height="328.5938" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="381.6563"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="552" y="280.2578"/><rect fill="#FFFFFF" height="299.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="552" y="410.7891"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="707" y="221.9922"/><rect fill="#FFFFFF" height="270.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="946" y="439.9219"/><rect fill="#FFFFFF" height="168.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1245" y="541.4531"/><rect fill="#FFFFFF" height="67.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1553" y="642.9844"/><rect fill="#FFFFFF" height="38.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1747" y="672.1172"/><rect fill="#FFFFFF" height="9" style="stroke:#181818;stroke-width:1.0;" width="10" x="1902" y="701.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="22" x2="22" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="206.5" x2="206.5" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="557" x2="557" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="712" x2="712" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="951" x2="951" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1250" x2="1250" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1558" x2="1558" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1752" x2="1752" y1="118.5938" y2="719.25"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1907" x2="1907" y1="118.5938" y2="719.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="115.292">用户</text><ellipse cx="22" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22,58.7969 L22,85.7969 M9,66.7969 L35,66.7969 M22,85.7969 L9,100.7969 M22,85.7969 L35,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="5" y="731.2451">用户</text><ellipse cx="22" cy="743.0469" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M22,751.0469 L22,778.0469 M9,759.0469 L35,759.0469 M22,778.0469 L9,793.0469 M22,778.0469 L35,793.0469 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="136.5" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="143.5" y="107.292">浏览器web（美西）</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="141" x="136.5" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127" x="143.5" y="738.2451">浏览器web（美西）</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="490" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="497" y="107.292">前端node（欧洲）</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="490" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="497" y="738.2451">前端node（欧洲）</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="634" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="641" y="107.292">mdc查询服务（欧洲）</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156" x="634" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="641" y="738.2451">mdc查询服务（欧洲）</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="880" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="887" y="107.292">mdc-nginx（欧洲）</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="880" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="887" y="738.2451">mdc-nginx（欧洲）</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="1179" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="1186" y="107.292">mdc-nginx（美西）</text><rect fill="#FFA500" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="1179" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="1186" y="738.2451">mdc-nginx（美西）</text><rect fill="#CD853F" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="1476" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1483" y="107.292">二层路由apisix（美西）</text><rect fill="#CD853F" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="164" x="1476" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="150" x="1483" y="738.2451">二层路由apisix（美西）</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1703" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1710" y="107.292">网关（美西）</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1703" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1710" y="738.2451">网关（美西）</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1858" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1865" y="107.292">后台（美西）</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="1858" y="718.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1865" y="738.2451">后台（美西）</text><rect fill="#FFFFFF" height="581.6563" style="stroke:#181818;stroke-width:1.0;" width="10" x="17" y="128.5938"/><rect fill="#FFFFFF" height="116.5313" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="192.8594"/><rect fill="#FFFFFF" height="328.5938" style="stroke:#181818;stroke-width:1.0;" width="10" x="202" y="381.6563"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="552" y="280.2578"/><rect fill="#FFFFFF" height="299.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="552" y="410.7891"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="707" y="221.9922"/><rect fill="#FFFFFF" height="270.3281" style="stroke:#181818;stroke-width:1.0;" width="10" x="946" y="439.9219"/><rect fill="#FFFFFF" height="168.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="1245" y="541.4531"/><rect fill="#FFFFFF" height="67.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1553" y="642.9844"/><rect fill="#FFFFFF" height="38.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1747" y="672.1172"/><rect fill="#FFFFFF" height="9" style="stroke:#181818;stroke-width:1.0;" width="10" x="1902" y="701.25"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1961" x="0" y="149.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1961" y1="149.1602" y2="149.1602"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1961" y1="152.1602" y2="152.1602"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="173" x="894" y="138.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="154" x="900" y="154.6606">确定用户对应后台的区域</text><polygon fill="#181818" points="190,188.8594,200,192.8594,190,196.8594,194,192.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="27" x2="196" y1="192.8594" y2="192.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="34" y="187.7935">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="47" y="187.7935">登录页面，输入用户邮箱</text><polygon fill="#181818" points="695,217.9922,705,221.9922,695,225.9922,699,221.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="701" y1="221.9922" y2="221.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="219" y="216.9263">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="232" y="216.9263">根据邮箱查询用户区域归属</text><polygon fill="#181818" points="223,247.125,213,251.125,223,255.125,219,251.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="217" x2="711" y1="251.125" y2="251.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="229" y="246.0591">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="242" y="246.0591">返回用户区域”mdc-usa“</text><polygon fill="#181818" points="540,276.2578,550,280.2578,540,284.2578,544,280.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="546" y1="280.2578" y2="280.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="219" y="275.1919">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="232" y="275.1919">上报”mdc-usa“</text><polygon fill="#181818" points="218,305.3906,208,309.3906,218,313.3906,214,309.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="556" y1="309.3906" y2="309.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="224" y="304.3247">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303" x="237" y="304.3247">通过setCookie的方式，把mdc-usa保存到cookie中</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1961" x="0" y="337.957"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1961" y1="337.957" y2="337.957"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1961" y1="340.957" y2="340.957"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="383" x="789" y="327.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="364" x="795" y="343.4575">所有请求，根据用户区域自动流转到对应的区域的后台服务</text><polygon fill="#181818" points="190,377.6563,200,381.6563,190,385.6563,194,381.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="27" x2="196" y1="381.6563" y2="381.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="34" y="376.5903">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="47" y="376.5903">任意请求</text><polygon fill="#181818" points="540,406.7891,550,410.7891,540,414.7891,544,410.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="212" x2="546" y1="410.7891" y2="410.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="219" y="405.7231">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="232" y="405.7231">任意请求，会把cookie中的”mdc-usa“带上</text><polygon fill="#181818" points="934,435.9219,944,439.9219,934,443.9219,938,439.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="562" x2="940" y1="439.9219" y2="439.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="569" y="434.856">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="352" x="582" y="434.856">后续所有请求都会在header中带上”mdc-area = mdc-usa“</text><line style="stroke:#181818;stroke-width:1.0;" x1="956" x2="998" y1="499.3203" y2="499.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="998" x2="998" y1="499.3203" y2="512.3203"/><line style="stroke:#181818;stroke-width:1.0;" x1="957" x2="998" y1="512.3203" y2="512.3203"/><polygon fill="#181818" points="967,508.3203,957,512.3203,967,516.3203,963,512.3203" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="963" y="479.1216">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="976" y="463.9888">根据”mdc-area“判断是否需要进行跨区流转</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="976" y="479.1216">当前值为mdc-usa，当前服务是欧洲</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="976" y="494.2544">需要转区</text><polygon fill="#181818" points="1233,537.4531,1243,541.4531,1233,545.4531,1237,541.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="956" x2="1239" y1="541.4531" y2="541.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="963" y="536.3872">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="985" y="536.3872">请求流转给到美西的mdc-nginx</text><line style="stroke:#181818;stroke-width:1.0;" x1="1255" x2="1297" y1="600.8516" y2="600.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="1297" x2="1297" y1="600.8516" y2="613.8516"/><line style="stroke:#181818;stroke-width:1.0;" x1="1256" x2="1297" y1="613.8516" y2="613.8516"/><polygon fill="#181818" points="1266,609.8516,1256,613.8516,1266,617.8516,1262,613.8516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1262" y="580.6528">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="1284" y="565.52">根据”mdc-area“判断是否需要进行跨区流转</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="1284" y="580.6528">当前值为mdc-usa，当前服务是美西</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="1284" y="595.7856">不需要转区</text><polygon fill="#181818" points="1541,638.9844,1551,642.9844,1541,646.9844,1545,642.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1255" x2="1547" y1="642.9844" y2="642.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1262" y="637.9185">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="1284" y="637.9185">请求流转给到二层的apisix</text><polygon fill="#181818" points="1735,668.1172,1745,672.1172,1735,676.1172,1739,672.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1563" x2="1741" y1="672.1172" y2="672.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1570" y="667.0513">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="1592" y="667.0513">前端的请求流转给到网关</text><polygon fill="#181818" points="1890,697.25,1900,701.25,1890,705.25,1894,701.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1757" x2="1896" y1="701.25" y2="701.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1764" y="696.1841">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="1786" y="696.1841">请求流转给到后台</text></g></svg>